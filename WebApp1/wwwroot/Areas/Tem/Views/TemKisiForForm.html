
<!-- Auto Generated user1 -->

<div id='TemKisiForForm'>
    <div id='divButtonGroup' class='mnButtonGroup float-right'>
        <div class='dropdown' style='position:absolute; right:40px;'>
            <button type='button' class='btn btn-outline-primary fa fa-ellipsis-h' data-toggle='dropdown' style='padding:2px 9px;'></button>
            <div class='dropdown-menu rounded-0 mn-default-border-color mn-default-bg-color mn-default-text-color shadow ' style='padding:5px 0px;'>
                <button id='btnDetayTemKullanici' class='dropdown-item mn-hover-color-blue'> <span data-langkey-text='xTem.TemKullanici.Title'></span> </button>

            </div>
        </div>

        <button id='btnKaydet' type='button' class='btn btn-outline-success text-nowrap' data-langkey-title='xLng.Kaydet' style='position:absolute; right:0px;'> <i class='fa fa-save'></i> </button>
    </div>

    <div style='padding-bottom:15px;'>
        <div id='tabstrip'>
            <ul>
                <li> <span data-langkey-text='xTem.TemKisi.FormViewTab.I'></span> </li>
                <li> <span data-langkey-text='xTem.TemKisi.FormViewTab.II'></span> </li>
            </ul>
        <div>
            <div class='mnFormElementContainer row'>
                     <div class='col-md-12'>

                    </div>

                     <div class='col-lg-6 col-md-12'>
                     <div name='divDurum' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label'></label>
                         <div class='col-sm-8'>
                            <label style='font-weight:normal;'>
                                <input name='Durum' type='checkbox' data-bind='checked:Durum' style='width: 24px; height: 24px; vertical-align: middle;'  />
                                <span data-langkey-Text='xTem.TemKisi.Durum'></span>
                            </label>
                         </div>
                     </div>

                     <div name='divKimlikNumarasi' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.KimlikNumarasi'></label>
                         <div class='col-sm-8'>
                             <input name='KimlikNumarasi' type='text' class='k-textbox' data-bind='value:KimlikNumarasi' data-langkey-placeholder='xTem.TemKisi.KimlikNumarasi'  autocomplete='off' />
                         </div>
                     </div>

                     <div name='divAd' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.Ad'></label>
                         <div class='col-sm-8'>
                             <input name='Ad' type='text' class='k-textbox' data-bind='value:Ad' data-langkey-placeholder='xTem.TemKisi.Ad'  autocomplete='off' />
                         </div>
                     </div>

                     <div name='divSoyad' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.Soyad'></label>
                         <div class='col-sm-8'>
                             <input name='Soyad' type='text' class='k-textbox' data-bind='value:Soyad' data-langkey-placeholder='xTem.TemKisi.Soyad'  autocomplete='off' />
                         </div>
                     </div>

                     <div name='divAdres' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.Adres'></label>
                         <div class='col-sm-8'>
                             <textarea name='Adres' class='k-textbox' data-bind='value:Adres' data-langkey-placeholder='xTem.TemKisi.Adres'  style='height:114px;' ></textarea>
                         </div>
                     </div>

                     <div name='divIlceId' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.IlceId'></label>
                         <div class='col-sm-8'>
                             <input name='IlceId' data-bind='value:IlceId' />
                             <span class='k-invalid-msg' data-for='IlceId'></span>
                         </div>
                     </div>


                    </div>

                     <div class='col-lg-6 col-md-12'>
                     <div name='divKayitZaman' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.KayitZaman'></label>
                         <div class='col-sm-8'>
                             <input name='KayitZaman' data-bind='value:KayitZaman'  disabled />
                             <span class='k-invalid-msg' data-for='KayitZaman'></span>
                         </div>
                     </div>

                     <div name='divMobilTelefon' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.MobilTelefon'></label>
                         <div class='col-sm-8'>
                             <input name='MobilTelefon' type='text' class='k-textbox' data-bind='value:MobilTelefon' data-langkey-placeholder='xTem.TemKisi.MobilTelefon'  autocomplete='off' />
                         </div>
                     </div>

                     <div name='divSabitTelefon' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.SabitTelefon'></label>
                         <div class='col-sm-8'>
                             <input name='SabitTelefon' type='text' class='k-textbox' data-bind='value:SabitTelefon' data-langkey-placeholder='xTem.TemKisi.SabitTelefon'  autocomplete='off' />
                         </div>
                     </div>

                     <div name='divFaxNumarasi' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.FaxNumarasi'></label>
                         <div class='col-sm-8'>
                             <input name='FaxNumarasi' type='text' class='k-textbox' data-bind='value:FaxNumarasi' data-langkey-placeholder='xTem.TemKisi.FaxNumarasi'  autocomplete='off' />
                         </div>
                     </div>

                     <div name='divMailAdres' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.MailAdres'></label>
                         <div class='col-sm-8'>
                             <input name='MailAdres' type='text' class='k-textbox' data-bind='value:MailAdres' data-langkey-placeholder='xTem.TemKisi.MailAdres'  autocomplete='off' />
                         </div>
                     </div>

                     <div name='divEgitimDurumId' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.EgitimDurumId'></label>
                         <div class='col-sm-8'>
                             <input name='EgitimDurumId' data-bind='value:EgitimDurumId' />
                             <span class='k-invalid-msg' data-for='EgitimDurumId'></span>
                         </div>
                     </div>

                     <div name='divCinsiyetId' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.CinsiyetId'></label>
                         <div class='col-sm-8'>
                             <input name='CinsiyetId' data-bind='value:CinsiyetId' />
                             <span class='k-invalid-msg' data-for='CinsiyetId'></span>
                         </div>
                     </div>

                     <div name='divKanGrup' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-form-label' data-langkey-text='xTem.TemKisi.KanGrup'></label>
                         <div class='col-sm-8'>
                             <input name='KanGrup' data-bind='value:KanGrup' />
                             <span class='k-invalid-msg' data-for='KanGrup'></span>
                         </div>
                     </div>


                    </div>

                </div>
            </div>
        <div>
            <div class='mnFormElementContainer row'>
                     <div class='col-md-12'>
                     <div name='divAciklama' class='mnFormElementDiv form-group row'>
                         <label class='col-sm-4 col-md-2 col-form-label' data-langkey-text='xTem.TemKisi.Aciklama'></label>
                         <div class='col-sm-8 col-md-10'>
                             <textarea name='Aciklama' type='text' class='k-textbox' data-bind='value:Aciklama' data-langkey-placeholder='xTem.TemKisi.Aciklama' style='height:500px;'></textarea>
                         </div>
                     </div>


                    </div>

                     <div class='col-lg-6 col-md-12'>

                    </div>

                     <div class='col-lg-6 col-md-12'>

                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<script>
 window.TemKisiForForm = function () {
     var self = {};
     self.opt = null;
     self.area = 'Tem';
     self.title = 'xTem.TemKisi.Title';
     self.selector = '#TemKisiForForm';
     self.primaryKey = 'Id';
     self.tableName = 'TemKisi';
     self.apiUrlPrefix = '/' + self.area + '/Dwa' + self.tableName;

     function fCreateDataSource() {
         self.dataSource = new kendo.data.DataSource({
             transport: {
                 read: { type: 'GET', url: self.apiUrlPrefix + '/Read', dataType: 'json', contentType: 'application/json; charset=utf-8' },
                 create: { type: 'POST', url: self.apiUrlPrefix + '/Create', dataType: 'json', contentType: 'application/json; charset=utf-8' },
                 update: { type: 'POST', url: self.apiUrlPrefix + '/Update', dataType: 'json', contentType: 'application/json; charset=utf-8' },
                 destroy: { type: 'POST', url: self.apiUrlPrefix + '/Delete', dataType: 'json' },
                 parameterMap: function (data, operation) {
                     if (operation === 'read') {
                         return (new kendo.data.transports['aspnetmvc-ajax']({})).options.parameterMap(data);
                     }
                     else if (operation === 'create' || operation === 'update') {
                         data.KayitZaman = kendo.toString(data.KayitZaman, 's');
                         return kendo.stringify(data);
                     }
                     else if (operation === 'destroy') {
                         return { _id: data[self.primaryKey] };
                     }
                 }
             },
             pageSize: 10, serverPaging: true, serverSorting: true, serverFiltering: true, serverGrouping: true, serverAggregates: true,
             schema: {
                 errors: 'Errors', data: 'Data', total: 'Total', aggregates: 'AggregateResults',
                 model: {
                     id: self.primaryKey,
                     fields: {
                         Id: { type: 'number', defaultValue: null },
                         Durum: { type: 'boolean' },
                         KayitZaman: { type: 'date', editable:false },
                         KimlikNumarasi: { type: 'string' },
                         Ad: { type: 'string' },
                         Soyad: { type: 'string' },
                         Adres: { type: 'string' },
                         IlceId: { type: 'number' },
                         MobilTelefon: { type: 'string' },
                         SabitTelefon: { type: 'string' },
                         FaxNumarasi: { type: 'string' },
                         MailAdres: { type: 'string' },
                         EgitimDurumId: { type: 'number' },
                         CinsiyetId: { type: 'number' },
                         KanGrup: { type: 'string' },
                         Aciklama: { type: 'string' },
                         CcDurum: { type: 'string' },
                         CcIlceId: { type: 'string' },
                         CcEgitimDurumIdAd: { type: 'string' },
                         CcCinsiyetIdAd: { type: 'string' },
                         CcKanGrup: { type: 'string' }
                     }
                 }
             },
             error: function (e) {
                 if (e.xhr === null) { mnNotification.warning(e.errors); } else { mnErrorHandler.Handle(e.xhr); }
                 //this.cancelChanges();
             },
             requestStart: function (e) {
                 setTimeout(function () {
                     kendo.ui.progress($(self.selector), true); //progress On
                 });
             },
             requestEnd: function (e) {
                 setTimeout(function () {
                     kendo.ui.progress($(self.selector), false); //progress Off
                 });

                 if (e.response !== undefined && e.response.Errors === null) {
                     if (e.type === 'create' || e.type === 'update' || e.type === 'destroy') {
                         mnLookup.listRead(self.tableName);
                     }
                     if (e.type === 'create') {
                         mnNotification.success(mnLang.TranslateWithWord('xLng.KayitEklendi'));
                     }
                     if (e.type === 'update') {
                         mnNotification.success(mnLang.TranslateWithWord('xLng.KayitDuzeltildi'));
                     }
                     if (e.type === 'destroy') {
                         mnNotification.success(mnLang.TranslateWithWord('xLng.KayitSilindi'));
                     }

                     if (e.response.Data.length > 0) {
                         var row = e.response.Data[0];
                     }
                 }
             },
             change: function (e) {
                 if (e.items[0] !== undefined) {
                     if (e.items[0].get(self.primaryKey) === null) {
                         $.ajax({
                             url: self.apiUrlPrefix + '/GetByNew', type: 'GET', dataType: 'json', async: false,
                             success: function (result) {
                                 e.items[0].Id = result.Id;
                                 e.items[0].Durum = result.Durum;
                                 e.items[0].KayitZaman = kendo.parseDate(result.KayitZaman);
                                 e.items[0].KimlikNumarasi = result.KimlikNumarasi;
                                 e.items[0].Ad = result.Ad;
                                 e.items[0].Soyad = result.Soyad;
                                 e.items[0].Adres = result.Adres;
                                 e.items[0].IlceId = result.IlceId;
                                 e.items[0].MobilTelefon = result.MobilTelefon;
                                 e.items[0].SabitTelefon = result.SabitTelefon;
                                 e.items[0].FaxNumarasi = result.FaxNumarasi;
                                 e.items[0].MailAdres = result.MailAdres;
                                 e.items[0].EgitimDurumId = result.EgitimDurumId;
                                 e.items[0].CinsiyetId = result.CinsiyetId;
                                 e.items[0].KanGrup = result.KanGrup;
                                 e.items[0].Aciklama = result.Aciklama;
                                 //computed alanların tanımlanması
                                 e.items[0].CcDurum = result.CcDurum;
                                 e.items[0].CcIlceId = result.CcIlceId;
                                 e.items[0].CcEgitimDurumIdAd = result.CcEgitimDurumIdAd;
                                 e.items[0].CcCinsiyetIdAd = result.CcCinsiyetIdAd;
                                 e.items[0].CcKanGrup = result.CcKanGrup;
                                 //filterdan gelen default value set için
                                 $(self.opt.filters).each(function (index, row) {
                                     if (row.filterColumnName !== 'Id') {
                                        e.items[0].set(row.filterColumnName, row.filterValue);
                                     }
                                 });

                             },
                             error: function (xhr, status) {
                                 mnErrorHandler.Handle(xhr);
                             }
                         });
                     }
                     // Bind
                     kendo.bind($(self.selector), e.items[0]);
                     self.validator.validate();
                 }

                 // Yetki
                 fYetkiUygula();

                 // ve gerekebilecek diğer işlemler
                 // ...
             }
         });
     }

     function fCreateFormElements() {
         // tabstrip
         self.tabstrip = $(self.selector).find('#tabstrip').kendoTabStrip({
             animation: false, tabPosition: 'top'
         }).getKendoTabStrip();
         self.tabstrip.select(0);

         //validator
         let formElm = $(self.selector).find('.mnFormElementContainer');
         self.validator = mnApp.createValidator(formElm, mnApp.validatorErrorTemplateIconMsg);

         //butonlar
         $(self.selector).find('#btnKaydet').click(function (e) {
             mnApi.controlDisableWait($(e.target));
             if (self.validator.validate()) {
                 if (self.dataSource.at(0).dirty) {
                     self.dataSource.sync();
                 } else {
                     mnAlert.warning(mnLang.TranslateWithWord('xLng.KayyittaDegisiklikYapmadiniz'));
                 }
             } else {
                 mnAlert.warning(mnLang.TranslateWithWord('xLng.DoldurulmasiGerekenAlanlarVar'));
             }
         });

         $(self.selector).find('#btnDetayTemKullanici').click(function (e) {
            var dataItem = self.dataSource.at(0);
            mnPageView.create({
                areaName: 'Tem',
                viewFileName: 'TemKullaniciForGrid',
                viewName: 'TemKullaniciForGrid',
                subTitle: mnLang.TranslateWithWord('xLng.DuzenlemeIslemleri'),
                onShow: function (e) {
                    e.beforeShow({
                        'ownerViewName': 'TemKisiForForm',
                        'filters': [
                            { 'filterColumnName': 'SahipTur', 'filterOperator': 'eq', 'filterValue': 21 },
                            { 'filterColumnName': 'SahipId', 'filterOperator': 'eq', 'filterValue': dataItem.Id }
                        ]
                    });
                }
            });
         });

         //Diğer Form elementleri
         $(self.selector).find('[name=KayitZaman]').kendoDateTimePicker({
             componentType: mnApp.kendoDateTimePiker_ComponentType,
             dateInput: mnApp.kendoDateTimePiker_DateInput
         }).getKendoDateTimePicker();

         $(self.selector).find('[name=IlceId]').kendoDropDownList({
             filter: 'contains',
             valuePrimitive: true,
             optionLabel: mnLang.TranslateWithWord('xLng.Seciniz'),
             dataValueField: 'value',
             dataTextField: 'text',
             dataSource: mnLookup.list.dsUlkeSehirIlce,
             open: function (e) {
             },
             close: function (e) {
             }
         }).getKendoDropDownList();

         $(self.selector).find('[name=EgitimDurumId]').kendoDropDownList({
             valuePrimitive: true,
             optionLabel: mnLang.TranslateWithWord('xLng.Seciniz'),
             dataValueField: 'value',
             dataTextField: 'text',
             dataSource: mnLookup.listLoad({
                 TableName: 'TemEgitimDurum',
                 ValueField: 'Id',
                 TextField: 'Ad',
                 OtherFields: '',
                 Filters: [
                     { Field: 'Id', Operator: '>=', Value: '0', ValueType: 'Int' }
                 ],
                 Sorts: [
                 ]
             }),
             open: function (e) {
             },
             close: function (e) {
             }
         }).getKendoDropDownList();

         $(self.selector).find('[name=CinsiyetId]').kendoDropDownList({
             valuePrimitive: true,
             optionLabel: mnLang.TranslateWithWord('xLng.Seciniz'),
             dataValueField: 'value',
             dataTextField: 'text',
             dataSource: mnLookup.listLoad({
                 TableName: 'TemCinsiyet',
                 ValueField: 'Id',
                 TextField: 'Ad',
                 OtherFields: '',
                 Filters: [
                     { Field: 'Id', Operator: '>=', Value: '0', ValueType: 'Int' }
                 ],
                 Sorts: [
                 ]
             }),
             open: function (e) {
             },
             close: function (e) {
             }
         }).getKendoDropDownList();

         $(self.selector).find('[name=KanGrup]').kendoDropDownList({
             valuePrimitive: true,
             optionLabel: mnLang.TranslateWithWord('xLng.Seciniz'),
             dataValueField: 'value',
             dataTextField: 'text',
             dataSource: mnLookup.list.dsKanGrup,
             open: function (e) {
             },
             close: function (e) {
             }
         }).getKendoDropDownList();

         self.keAciklama = $(self.selector).find('[name=Aciklama]').kendoEditor({
             serialization: { entities: false },
             tools: ['bold','italic','underline','strikethrough','justifyLeft','justifyCenter','justifyRight','justifyFull','insertUnorderedList','insertOrderedList','indent','outdent','createLink','unlink','insertImage','insertFile','subscript','superscript','tableWizard','createTable','addRowAbove','addRowBelow','addColumnLeft','addColumnRight','deleteRow','deleteColumn','viewHtml','formatting','cleanFormatting','fontName','fontSize','foreColor','backColor','print'],
             resizable: { content: true }
         }).getKendoEditor();

     }

     function fSetAtributeFormElements() {
         $(self.selector).find('[name=KayitZaman]').attr('required', 'required');
         $(self.selector).find('[name=KimlikNumarasi]').attr('required', 'required');
         $(self.selector).find('[name=IlceId]').attr('required', 'required');
         $(self.selector).find('[name=MailAdres]').attr('required', 'required');
         $(self.selector).find('[name=EgitimDurumId]').attr('required', 'required');
         $(self.selector).find('[name=CinsiyetId]').attr('required', 'required');
     }

     function fYetkiUygula() {
         //Standart Yetkiler
         var _C = mnUser.isYetkili(self.tableName + '.D_C.');
         var _U = mnUser.isYetkili(self.tableName + '.D_U.');
         var _D = mnUser.isYetkili(self.tableName + '.D_D.');

             // menu buttons yetkiler için
             var btnDetayTemKullanici_R = mnUser.isYetkili('TemKullanici.D_R.');
             mnApi.controlEnable($(self.selector).find('#btnDetayTemKullanici'), btnDetayTemKullanici_R);


         //ek yetkiler için)
         //...

         //Form İçin
         if (_C || _U) {
             $(self.selector).find('#btnKaydet').show();
         } else {
             $(self.selector).find('#btnKaydet').hide();
         }

        //form element görünümleri
        var fieldList = [];
        fieldList.push({ 'Name': 'Durum', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'KayitZaman', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'KimlikNumarasi', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'Ad', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'Soyad', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'Adres', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'IlceId', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'MobilTelefon', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'SabitTelefon', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'FaxNumarasi', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'MailAdres', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'EgitimDurumId', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'CinsiyetId', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'KanGrup', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });
        fieldList.push({ 'Name': 'Aciklama', 'Visible': '11,21,31,41'.indexOf(mnUser.Info.nYetkiGrup) >= 0 });

        for (var i in fieldList) {
            var $elm = $(self.selector).find('.mnFormElementContainer .mnFormElementDiv[name=div' + fieldList[i].Name + ']');
            if (fieldList[i].Visible) {
                $elm.show();
            } else {
                $elm.hide();
            }
        }

     }


     function fGorunurlukUygula(dataItem) {

        if (dataItem != null && dataItem != undefined) {
        }
     }

     self.prepare = function () {
         // form element atribute set
         fSetAtributeFormElements();
         // DataSource
         fCreateDataSource();
         // form Elementler
         fCreateFormElements();
         // Language
         mnLang.TranslateWithSelector(self.selector);
     };

     self.beforeShow = function (_opt) {
         self.opt = $.extend({}, _opt);

         if (self.opt.qprms.Id !== null && self.opt.qprms.Id > 0) {
             self.dataSource.filter({ field: self.primaryKey, operator: 'eq', value: self.opt.qprms.Id });
         } else {
             self.dataSource.data([]); // eski data varsa işleme girmemesi için
             self.dataSource.add();
         }

         self.tabstrip.select(0);
     };

     return self;
 }();
</script>
